# Telegram Bot V2 快速开始指南

## 🚀 快速启动

### 1. 默认运行 V2（推荐）

```bash
python run_telegram_bot.py
```

### 2. 运行 V1（旧版）

```bash
python run_telegram_bot.py --v1
```

### 3. 查看版本信息

```bash
python run_telegram_bot.py --version
```

---

## 🎯 主要改进

| 功能 | V1 | V2 |
|------|----|----|
| 界面语言 | 中英混合 | 统一中文 |
| 加载提示 | 无 | 多步骤进度 |
| 删除确认 | 无 | 有 |
| 错误提示 | 简单 | 详细+建议 |
| 持仓分页 | 无 | 每页10个 |
| 交互添加 | 无 | 有(`/add2`) |

---

## 📖 使用示例

### 查看持仓（带分页）

```
用户: /portfolio

Bot: 💼 我的持仓
     ==============================
     📊 持仓总数: 25 只
     ...
     📄 页码: 1/3

     [🔄 刷新] [➕ 添加]
     [🔙 主菜单]
```

### 交互式添加持仓

```
用户: /add2

Bot: ➕ 添加持仓
     请输入股票代码（6位数字）

     示例: 300033

     [❌ 使用 /cancel 取消]

用户: 300033

Bot: ➕ 添加持仓
     股票代码: 300033

     请输入持仓数量:

     示例: 1000

用户: 1000

Bot: ➕ 添加持仓
     股票代码: 300033
     持仓数量: 1,000 股

     请输入成本价格:

     示例: 77.85

用户: 77.85

Bot: ➕ 确认添加持仓

     股票代码: 300033
     持仓数量: 1,000 股
     成本价格: ¥77.85
     持仓市值: ¥77,850.00

     确认添加吗？

     ✅ 回复 "确认" 或 "y" 添加
     ❌ 回复 "取消" 或 "n" 放弃

用户: 确认

Bot: ✅ 持仓添加成功！

     股票代码: 300033
     持仓数量: 1,000 股
     成本价格: ¥77.85
     持仓市值: ¥77,850.00

     💡 使用 /portfolio 查看完整持仓
```

### 删除持仓（带确认）

```
用户: /delete 300033

Bot: ⚠️ 确认删除持仓

     股票: 五洲新春
     代码: 300033
     数量: 1,000 股
     成本: ¥77.85

     ⚠️ 此操作不可恢复！

     [✅ 确认删除] [❌ 取消]
```

### 上传截图（带加载提示）

```
用户: [上传图片]

Bot: ⏳ 正在处理图片...

     📸 下载图片中...
     🤖 AI 识别中...
     💾 保存数据中...

     [几秒后]

Bot: ✅ 持仓同步成功！

     📊 新增: 5 只
     🔄 更新: 2 只
     📈 总计: 7 只

     💡 使用 /portfolio 查看详细持仓
```

### 错误处理（带建议）

```
Bot: ❌ 图片处理失败

     错误信息: API 请求超时

     💡 建议:
       1. 检查网络连接
       2. 尝试重新发送图片
       3. 确认 API 密钥配置正确

     ℹ️ 使用 /help 查看帮助信息
```

---

## 🎮 新菜单导航

### 主菜单按钮

```
[💼 我的持仓] → 查看和管理持仓
[📊 行业板块] → 浏览板块信息
[📈 实时行情] → 市场数据（开发中）
[🔍 快捷操作] → 常用功能快捷入口
[⚙️  系统设置] → 设置上传模式
[ℹ️  帮助中心] → 查看帮助信息
```

### 持仓页面按钮

```
[🔄 刷新] → 更新实时价格
[➕ 添加] → 快速添加持仓
[🔍 搜索] → 搜索持仓（开发中）
[📤 导出] → 导出数据（开发中）
[上一页] [1/3] [下一页] → 分页导航
[🏠 主菜单] → 返回主菜单
```

---

## 📋 命令参考

### 基础命令

| 命令 | 说明 |
|------|------|
| `/start` | 打开主菜单 |
| `/help` | 显示帮助信息 |
| `/status` | 系统状态 |
| `/risk` | 风险评估 |

### 持仓管理

| 命令 | 说明 |
|------|------|
| `/portfolio` | 查看持仓（分页显示） |
| `/add` ... | 快速添加（参数模式） |
| `/add2` | 交互式添加 |
| `/delete` ... | 删除持仓（带确认） |
| `/clear` | 清空持仓（带确认） |

### 板块管理

| 命令 | 说明 |
|------|------|
| `/sectors` | 查看所有板块 |
| `/sector` ... | 查看板块详情 |

### 设置

| 命令 | 说明 |
|------|------|
| `/mode` portfolio | 切换到持仓模式 |
| `/mode` sector | 切换到板块模式 |

---

## 🔧 配置检查

确保 `.env` 文件包含以下配置：

```bash
# Telegram Bot
TG_BOT_TOKEN=your_bot_token_here

# AI Vision（三选一）
AI_VISION_PROVIDER=zhipu  # 或 openai/claude
ZHIPU_API_KEY=your_zhipu_key
# OPENAI_API_KEY=your_openai_key
# ANTHROPIC_API_KEY=your_anthropic_key

# Tushare（可选，用于获取实时价格）
TUSHARE_TOKEN=your_tushare_token
```

---

## 🐛 常见问题

### Q: 如何切换回 V1？

```bash
python run_telegram_bot.py --v1
```

### Q: 持仓太多显示不全？

V2 自动分页，每页显示 10 个持仓，使用按钮翻页。

### Q: 如何取消正在进行的操作？

使用 `/cancel` 命令或回复"取消"。

### Q: 图片识别失败怎么办？

1. 确保图片清晰完整
2. 检查 API 密钥配置
3. 查看错误消息中的建议
4. 尝试重新上传

### Q: 如何查看帮助？

使用 `/help` 命令或点击主菜单的 [ℹ️ 帮助中心]

---

## 📚 更多信息

- 完整文档: `TELEGRAM_BOT_V2_OPTIMIZATION.md`
- 原版说明: `QUICKSTART_TELEGRAM.md`

---

**享受更好的 Telegram Bot 体验！** 🎉
